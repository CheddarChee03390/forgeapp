<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etsy Inventory - Master Stock Management</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-title">üì¶ Master Stock Management</h1>
            <div class="nav-links">
                <a href="/" class="nav-link">Dashboard</a>
                <a href="/materials.html" class="nav-link">Materials</a>
                <a href="/products.html" class="nav-link">Master Stock</a>
                <a href="/etsy.html" class="nav-link active">Etsy Inventory</a>
                <a href="/pricing.html" class="nav-link">Pricing</a>
                <a href="/import.html" class="nav-link">Import</a>
                <a href="/sales-analytics.html" class="nav-link">üí∞ Sales & Tax</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="page-header">
            <h2>üõçÔ∏è Etsy Inventory</h2>
            <div class="header-actions">
                <button id="btnConnect" class="btn btn-success" style="display:none;">üîó Connect to Etsy</button>
                <button id="btnSync" class="btn btn-primary" style="display:none;">üîÑ Sync from Etsy</button>
                <button id="btnDisconnect" class="btn btn-secondary" style="display:none;">üîì Disconnect</button>
            </div>
        </div>

        <!-- Authentication Status -->
        <div id="authStatus" class="card" style="display:none;">
            <h3>‚ö†Ô∏è Not Connected</h3>
            <p>Please connect to your Etsy account to view inventory.</p>
        </div>

        <!-- Stats Dashboard -->
        <div class="stats-section" id="statsSection" style="display:none;">
            <div class="stat-card">
                <div class="stat-number" id="statTotal">-</div>
                <div class="stat-label">Total Listings</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statActive">-</div>
                <div class="stat-label">Active</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statVariations">-</div>
                <div class="stat-label">Total Variations</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statWithVariations">-</div>
                <div class="stat-label">With Variations</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statQuantity">-</div>
                <div class="stat-label">Total Quantity</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statUnmapped">-</div>
                <div class="stat-label">Unmapped</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statLowStock">-</div>
                <div class="stat-label">Low Stock</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statActiveMappings">-</div>
                <div class="stat-label">Active Mappings</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statInactiveMappings">-</div>
                <div class="stat-label">Inactive Mappings</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statLastSync">-</div>
                <div class="stat-label">Last Synced</div>
            </div>
        </div>

        <!-- Search and Filter -->
        <div class="card">
            <div class="search-section">
                <input type="text" id="searchInput" class="form-control" placeholder="Search by title or SKU...">
                <button id="btnSearch" class="btn btn-primary">Search</button>
                <button id="btnClearSearch" class="btn btn-secondary">Clear</button>
            </div>
            
            <!-- Filter Panel -->
            <div class="filter-panel" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #ddd;">
                <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.875rem;">Mapping Status</label>
                        <select id="filterMapping" class="form-control" aria-label="Filter by mapping status">
                            <option value="all">All Listings</option>
                            <option value="unmapped">Unmapped Only</option>
                            <option value="partial">Partially Mapped</option>
                            <option value="full">Fully Mapped</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.875rem;">Variations</label>
                        <select id="filterVariations" class="form-control" aria-label="Filter by variations">
                            <option value="all">All Listings</option>
                            <option value="with">With Variations</option>
                            <option value="without">Without Variations</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.875rem;">State</label>
                        <select id="filterState" class="form-control" aria-label="Filter by state">
                            <option value="all">All States</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div style="flex: 0; align-self: flex-end;">
                        <button id="btnResetFilters" class="btn btn-secondary">Reset Filters</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Listings Table -->
        <div class="card" id="listingsCard" style="display:none;">
            <h3>Etsy Listings</h3>
            <div class="table-container">
                <div class="table-scroll">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Listing ID</th>
                                <th>Title</th>
                                <th>SKU</th>
                                <th>Quantity</th>
                                <th>Price</th>
                                <th>State</th>
                                <th>Views</th>
                                <th>Favorites</th>
                                <th>Updated</th>
                                <th>Mapped SKUs</th>
                                <th>Variations</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="listingsTableBody">
                            <tr>
                                <td colspan="11" class="text-center">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script src="/etsy.js"></script>
</body>
</html>
